================================================================================
🗺️  全图推理脚本 - 单GPU优化版（RTX A5000）
================================================================================

[1] 配置参数...
   GPU: NVIDIA RTX A5000
   显存: 25.8 GB
   BATCH_SIZE: 512
   混合精度: 启用
   CPU工作进程: 6
   输出目录: F:\model_outputs_2020_resnet_optimized\maps_2020_optimized

[2] 检查文件路径...
✅ 所有文件检查通过

[3] 定义模型架构...
✅ 模型架构定义完成
推理进度: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 241/241 [22:53<00:00,  5.70s/it, windows=122,899, GPU_mem=0.0GB]

✅ 推理完成! 耗时: 0.39 小时
   处理窗口: 122,899

📊 归一化并写出结果（逐组分处理）...

   [1/4] F
      μ=0.3948, σ=0.2266, N=20,997,077
      ✅ pred_optimized_F_2020_90m.tif (292.9 MB)

   [2/4] F_NF
      μ=0.2617, σ=0.1390, N=20,997,077
      ✅ pred_optimized_F_NF_2020_90m.tif (292.1 MB)

   [3/4] NF_F
      μ=0.2018, σ=0.1218, N=20,997,077
      ✅ pred_optimized_NF_F_2020_90m.tif (293.4 MB)

   [4/4] NF
      μ=0.1417, σ=0.1151, N=20,997,077
      ✅ pred_optimized_NF_2020_90m.tif (294.3 MB)

================================================================================
🎉 全图推理完成！（单GPU优化版）
================================================================================

📁 输出文件:
   F:\model_outputs_2020_resnet_optimized\maps_2020_optimized\pred_optimized_F_2020_90m.tif
   F:\model_outputs_2020_resnet_optimized\maps_2020_optimized\pred_optimized_F_NF_2020_90m.tif
   F:\model_outputs_2020_resnet_optimized\maps_2020_optimized\pred_optimized_NF_F_2020_90m.tif
   F:\model_outputs_2020_resnet_optimized\maps_2020_optimized\pred_optimized_NF_2020_90m.tif

💡 优化效果:
   ✅ 预筛选: 过滤82.5%无效窗口
   ✅ 混合精度: FP16加速
   ✅ DataLoader: 多进程并行读取
   ✅ 断点续传: 支持随时中断恢复
   ✅ 大Batch: 充分利用24GB显存

   预期: 8小时 → 1-1.5小时